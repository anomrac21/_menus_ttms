<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
<meta name="viewport" content="width=device-width">
<title>Login | Tiny Tavern</title>
<meta name="description" content="Delicious food and drinks at great prices. View our digital menu and order online.">


<link rel="preload" href="https://ct.ttmenus.com/branding/ttmenus/ttmenus.gif" as="image" fetchpriority="high">
<link rel="preload" href="/branding/favicon144.webp" as="image" fetchpriority="high">
<link rel="preload" href="https://ct.ttmenus.com/css/loader.css" as="style" fetchpriority="high">


<style>
   
  #loader {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    background: var(--background-color, #000);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 99999;
    transition: opacity 0.5s ease-out, transform 0.5s ease-out;
  }
  
  #loader img {
    max-width: 200px;
    max-height: 200px;
    object-fit: contain;
    image-rendering: -webkit-optimize-contrast;
  }
  
  #loaderImage {
    
    animation: pulse 1.5s ease-in-out infinite;
  }
  
  #menuImage {
    width: 120px;
    height: 120px;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; transform: scale(1); }
    50% { opacity: 0.8; transform: scale(1.05); }
  }
  
   
  #loader.loader-hide-up,
  #loader.loader-hide-down,
  #loader.loader-hide-left,
  #loader.loader-hide-right {
    opacity: 0;
    pointer-events: none;
  }
  
  #loader.loader-hide-up { transform: translateY(-100%); }
  #loader.loader-hide-down { transform: translateY(100%); }
  #loader.loader-hide-left { transform: translateX(-100%); }
  #loader.loader-hide-right { transform: translateX(100%); }
</style>


<link rel="preconnect" href="https://ct.ttmenus.com" crossorigin>
<link rel="preconnect" href="https://cdn.onesignal.com" crossorigin>
<link rel="preconnect" href="https://analytics.ttmenus.com" crossorigin>
<link rel="preconnect" href="https://code.jquery.com" crossorigin>
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>
<link rel="preconnect" href="https://unpkg.com" crossorigin>
<link rel="dns-prefetch" href="https://cdn.jsdelivr.net">


      <link rel="stylesheet" href="/css/main.min.31fab1366650e901ec4e8f1845406a0f6a87d88682d0c292f0eb035d1f06c29f.css" integrity="sha256-MfqxNmZQ6QHsTo8YRUBqD2qH2IaC0MKS8OsDXR8Gwp8=" crossorigin="anonymous">


      <script src="/js/main.f2979a93a325fecf9605263bd141398a311c8e23388ed7dcff74f92f7e632866.js" integrity="sha256-8peak6Ml/s&#43;WBSY70UE5ijEcjiM4jtfc/3T5L35jKGY=" crossorigin="anonymous"></script>

<meta property="og:title" content="Login | Tiny Tavern"/>


 
   <meta property="og:image" content="/branding/favicon152.webp"/>



<meta name="apple-mobile-web-app-title" content="Tiny Tavern">
<meta name="description" content=" "/>
<meta property="og:description" content=" Digital Menu"/>


<meta property="og:url" content="https://tinytavern.ttmenus.com/" />


<meta name="theme-color" content="#000000"/>


<link rel="stylesheet" href="https://tinytavern.ttmenus.com/css/colors.css"/>
<link rel="stylesheet" href="https://tinytavern.ttmenus.com/css/custom.css"/>
<link rel="stylesheet" href="https://ct.ttmenus.com/css/loader.css"/>


<link rel="stylesheet" href="https://tinytavern.ttmenus.com/css/adsbase.css"/>

<link rel="preload" href="https://tinytavern.ttmenus.com/css/apple.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
<noscript><link rel="stylesheet" href="https://tinytavern.ttmenus.com/css/apple.css"/></noscript>

<link rel="preload" href="https://tinytavern.ttmenus.com/css/ordering-system.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
<noscript><link rel="stylesheet" href="https://tinytavern.ttmenus.com/css/ordering-system.css"/></noscript>

<link rel="preload" href="https://ct.ttmenus.com/css/animations.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
<noscript><link rel="stylesheet" href="https://ct.ttmenus.com/css/animations.css"/></noscript>

<link rel="preload" href="https://ct.ttmenus.com/css/dinein_select.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
<noscript><link rel="stylesheet" href="https://ct.ttmenus.com/css/dinein_select.css"/></noscript>

<link rel="preload" href="https://ct.ttmenus.com/css/search.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
<noscript><link rel="stylesheet" href="https://ct.ttmenus.com/css/search.css"/></noscript>


<link rel="manifest" href="/manifest.json" />


<link rel="apple-touch-icon" href="/branding/favicon192.webp" />
<link rel="shortcut icon" sizes="16x16" href="/branding/favicon16.webp">
<link rel="shortcut icon" sizes="196x196" href="/branding/favicon.ico">
<link rel="shortcut icon" sizes="196x196" href="/branding/favicon196.webp">
<link rel="apple-touch-icon" href="/branding/favicon192.webp" />
<link rel="shorcut icon" href="/branding/favicon512.webp"/>
<link rel="apple-touch-icon-precomposed" href="/branding/favicon152.webp">


<link rel="preload" href="https://unpkg.com/aos@2.3.1/dist/aos.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
<noscript><link href="https://unpkg.com/aos@2.3.1/dist/aos.css" rel="stylesheet"></noscript>


<link rel="preload" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'"/>
<noscript><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css"></noscript>
<style>
   
  @font-face {
    font-family: 'FontAwesome';
    font-display: swap;
  }
</style>




<script>
    if (typeof navigator.serviceWorker !== 'undefined') {
        navigator.serviceWorker.register('https:\/\/tinytavern.ttmenus.com\/OneSignalSDKWorker.js?v=2')
        .then(function(registration) {
        console.log('Service Worker registered with scope:', registration.scope);
        })
        .catch(function(error) {
        console.error('Service Worker registration failed:', error);
        });
    }
</script>
<script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
<script>
  window.OneSignalDeferred = window.OneSignalDeferred || [];
  OneSignalDeferred.push(function(OneSignal) {
    const appId = "9d041f45-1cc0-4e2e-9bc4-59778502838f";
    
    
    if (appId && appId.trim() !== "" && appId.indexOf("{" + "{") === -1) {
      OneSignal.init({
        appId: appId,
      }).catch(function(error) {
        console.warn('OneSignal initialization error:', error.message);
        
        if (error.message.includes("AppID doesn't match")) {
          console.log('OneSignal: AppID mismatch detected. Service worker may need to be cleared.');
        }
      });
    } else {
      console.warn('OneSignal: Invalid or missing appId, skipping initialization');
    }
  });
</script>

<script>
  
  window.addEventListener('load', function() {
    var _mtm = window._mtm = window._mtm || [];
    _mtm.push({'mtm.startTime': (new Date().getTime()), 'event': 'mtm.Start'});
    (function() {
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src='https://analytics.ttmenus.com/js/container_sfESrf87.js'; s.parentNode.insertBefore(g,s);
    })();
  });
</script>


<script>
  window.addEventListener('load', function() {
    var _paq = window._paq = window._paq || [];

     
    _paq.push(["setDocumentTitle", document.domain + "/" + document.title]);
    _paq.push(["setCookieDomain", "*.ttmenus.com"]);
    _paq.push(["setDomains", ["*.ttmenus.com"]]);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);

     
    _paq.push(['addTracker', 'https://analytics.ttmenus.com/matomo.php', '9']);
    _paq.push(['trackPageView']);
    _paq.push(['enableLinkTracking']);

    (function() {
      var u="//analytics.ttmenus.com/";
      _paq.push(['setTrackerUrl', u+'matomo.php']);
      _paq.push(['setSiteId', '1']);
      var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
      g.async=true; g.src=u+'matomo.js'; s.parentNode.insertBefore(g,s);
    })();
  });
</script>
<noscript><p><img referrerpolicy="no-referrer-when-downgrade" src="//analytics.ttmenus.com/matomo.php?idsite=1&amp;rec=1" style="border:0;" alt="" /></p></noscript>



<script src="https://tinytavern.ttmenus.com/js/analytics-tracking.js" defer></script><script>

window.AUTH_CONFIG = {
    apiUrl: "https:\/\/auth.ttmenus.com\/api\/v1"
};

window.SITE_CLIENT_ID = "";
</script>
<script src="https://tinytavern.ttmenus.com/js/auth-client.js"></script>
<script src="https://tinytavern.ttmenus.com/js/auth-middleware.js"></script>
<script src="https://tinytavern.ttmenus.com/js/auth-client-access.js"></script>
<script src="https://tinytavern.ttmenus.com/js/admin-users.js"></script>
  <link rel="stylesheet" href="https://tinytavern.ttmenus.com/css/auth.css">
</head>
<body>
  <div class="auth-container">
    <div class="auth-card">
      <div class="auth-header">
        <img src="https://tinytavern.ttmenus.com/branding/ttmenus.gif" alt="TTMenus Logo" class="auth-logo">
        <h1 class="auth-title">Welcome Back</h1>
        <p class="auth-subtitle">Sign in to access your dashboard</p>
      </div>

      
      <div id="alertContainer"></div>

      
      <form id="loginForm" class="auth-form">
        <div class="form-group">
          <label for="email" class="form-label">Email Address</label>
          <input 
            type="email" 
            id="email" 
            name="email" 
            class="form-input" 
            placeholder="you@example.com"
            required
            autocomplete="email"
          >
          <div class="form-error" id="emailError"></div>
        </div>

        <div class="form-group">
          <label for="password" class="form-label">Password</label>
          <input 
            type="password" 
            id="password" 
            name="password" 
            class="form-input" 
            placeholder="Enter your password"
            required
            autocomplete="current-password"
          >
          <div class="form-error" id="passwordError"></div>
        </div>

        <div class="form-checkbox">
          <input type="checkbox" id="rememberMe" name="rememberMe">
          <label for="rememberMe">Remember me</label>
        </div>

        <button type="submit" class="btn-primary" id="loginBtn">
          Sign In
        </button>
      </form>

      <div class="auth-links">
        <a href="/forgot-password/" class="auth-link">Forgot your password?</a>
      </div>

      <div class="auth-divider">
        <span>Need access?</span>
      </div>

      <p style="text-align: center; color: #666; font-size: 14px; margin: 10px 0;">
        Contact your administrator to create an account for you.
      </p>

      <div class="auth-links" style="margin-top: 20px;">
        <a href="/" class="auth-link">‚Üê Back to Home</a>
      </div>
    </div>
  </div>

  
  <script>
    
    document.addEventListener('DOMContentLoaded', () => {
      const form = document.getElementById('loginForm');
      const emailInput = document.getElementById('email');
      const passwordInput = document.getElementById('password');
      const loginBtn = document.getElementById('loginBtn');
      const alertContainer = document.getElementById('alertContainer');

      
      if (AuthClient.isAuthenticated()) {
        AuthMiddleware.redirectAfterLogin('/update-ui/');
        return;
      }

      
      form.addEventListener('submit', async (e) => {
        e.preventDefault();

        
        clearErrors();

        
        const email = emailInput.value.trim();
        const password = passwordInput.value;

        
        if (!email) {
          showError('emailError', 'Email is required');
          return;
        }

        if (!password) {
          showError('passwordError', 'Password is required');
          return;
        }

        
        loginBtn.disabled = true;
        loginBtn.innerHTML = '<span class="spinner"></span> Signing In...';

        try {
          
          console.log('üîê Attempting login...');
          console.log('üì° API URL:', AuthClient.config.apiUrl);
          
          
          const result = await AuthClient.login(email, password);
          console.log('üì• Login result:', result);

          if (result.success) {
            showAlert('success', 'Login successful! Redirecting...');
            
            
            setTimeout(() => {
              AuthMiddleware.redirectAfterLogin('/update-ui/');
            }, 1000);
          } else {
            console.error('‚ùå Login failed:', result.error);
            showAlert('error', result.error || 'Login failed. Please check your credentials.');
            loginBtn.disabled = false;
            loginBtn.innerHTML = 'Sign In';
          }
        } catch (error) {
          console.error('üí• Login exception:', error);
          
          
          let errorMessage = 'An unexpected error occurred. ';
          
          if (error.message === 'Failed to fetch' || error.message.includes('fetch')) {
            errorMessage = '‚ö†Ô∏è Cannot connect to authentication service. Please ensure the auth service is running on http://localhost:8080';
            console.error('üî¥ Auth service not reachable. Run: cd ttms-app-cluster/services/auth-service && go run cmd/main.go');
          } else if (error.message.includes('CORS')) {
            errorMessage = '‚ö†Ô∏è CORS error. Please check auth service CORS configuration.';
          } else if (error.message.includes('NetworkError')) {
            errorMessage = '‚ö†Ô∏è Network error. Please check your internet connection and auth service.';
          }
          
          showAlert('error', errorMessage);
          loginBtn.disabled = false;
          loginBtn.innerHTML = 'Sign In';
        }
      });

      
      function showError(elementId, message) {
        const errorElement = document.getElementById(elementId);
        if (errorElement) {
          errorElement.textContent = message;
          errorElement.classList.add('show');
          
          
          const inputId = elementId.replace('Error', '');
          const input = document.getElementById(inputId);
          if (input) {
            input.classList.add('error');
          }
        }
      }

      function clearErrors() {
        document.querySelectorAll('.form-error').forEach(el => {
          el.textContent = '';
          el.classList.remove('show');
        });
        document.querySelectorAll('.form-input').forEach(el => {
          el.classList.remove('error');
        });
      }

      function showAlert(type, message) {
        const alertDiv = document.createElement('div');
        alertDiv.className = `alert alert-${type}`;
        alertDiv.textContent = message;
        alertContainer.innerHTML = '';
        alertContainer.appendChild(alertDiv);
      }

      
      emailInput.addEventListener('input', () => {
        emailInput.classList.remove('error');
        document.getElementById('emailError').classList.remove('show');
      });

      passwordInput.addEventListener('input', () => {
        passwordInput.classList.remove('error');
        document.getElementById('passwordError').classList.remove('show');
      });
    });
  </script>
</body>
</html>

